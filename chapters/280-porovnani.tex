%https://tex.stackexchange.com/a/11709
\newcommand*\cleartoleftpage{%
  \clearpage
  \ifodd\value{page}\hbox{}\newpage\fi
}

\definecolor{tgreen}{rgb}{0.02,0.40,0.16}
\definecolor{tred}{rgb}{0.77,0.22,0.16}

\definecolor{green}{rgb}{0.78,0.91,0.85}
\definecolor{red}{rgb}{0.95,0.75,0.73}

\newcommand{\Cg}{\cellcolor{green}}
\newcommand{\CgA}{\cellcolor{green!100}}
\newcommand{\CgB}{\cellcolor{green!70}}
\newcommand{\CgC}{\cellcolor{green!40}}
\newcommand{\Cr}{\cellcolor{red}}
\newcommand{\CrA}{\cellcolor{red!100}}
\newcommand{\CrB}{\cellcolor{red!70}}
\newcommand{\CrC}{\cellcolor{red!40}}

\cleartoleftpage
\section{Souhrn}
    \label{overview}

    \begin{adjustwidth}{-2cm}{}
        \begin{tabular}{|r||p{3.2cm}|p{3.2cm}|p{2cm}|p{2cm}|p{2cm}}\hline
            & \textbf{GitLab 11.7} & \textbf{Jenkins 2.150} & \textbf{GoCD 19.1} & \textbf{Drone 1.0.0-rc.5} & \textbf{Concourse 4.2.2} \\\hline\hline
            \textbf{Homepage} & \url{about.gitlab.com} & \url{jenkins.io} & \url{gocd.org} & \url{drone.io} & \url{concourse-ci.org} \\\hline
            \textbf{SaaS} & \Cg zdarma, placené & třetí strany (CloudBees) & \textcolor{tred}{ne} & \textcolor{tgreen}{zdarma} & \textcolor{tred}{ne} \\\hline
            \textbf{Self-hosted} & \textcolor{tgreen}{zdarma, placené} & \Cg zdarma & \Cg zdarma & \textcolor{tgreen}{zdarma, placené} & \Cg zdarma \\\hline
            \textbf{Dostupnost masteru} & SPoF (může existovat víc masterů) & \textcolor{tred}{SPoF} & \textcolor{tred}{SPoF} & \textcolor{tred}{SPoF} & \Cg HA \\\hline
            \textbf{Možnosti izolace} & \multicolumn{3}{c|}{ \Cg žádná, kontejner, VM, fyzická } & kontejner, fyzická & kontejner, fyzická \\\hline
            \textbf{Joby} & \Cg host, kontejner (podle executoru) & \Cg host, kontejner (podle pipeline) & host & kontejner & kontejner  \\\hline
            \textbf{Rozšiřitelnost} & \textcolor{tred}{ne} & \Cg všechno, včetně UI & vybraná místa & \multicolumn{2}{c}{ minimální (na úrovni jobů) } \\\hline
            \textbf{Složitost pipeline} & \CgB 2 & \CrB 8 & 5 & \CgB 2 & \CrA 7 \\\hline
            \textbf{UX} & \CgA 1 & \CrB 8 & \CrC 7 & 4 & \CrA 9  \\\hline
            \textbf{Integrace} & GitLab, vestavěné & \multicolumn{2}{c|}{ \Cg z~rozšíření } & \multicolumn{2}{c}{ ne (řeší na úrovni jobů) } \\\hline
        \end{tabular}
    \end{adjustwidth}
    \vspace*{0.8cm}

    Tabulka na této dvojstraně vizualizuje silné a slabé stránky porovnávaných \CI nástrojů. Zeleně podbarvené buňky reprezentují nejlepší hodnoty.

    S~výjimkou GitLab jsou všechna \CI buď proprietární \glstext{SaaS} nebo zdarma, open-source a self-hosted. GitLab má odlišnou strategii a prodává licence i pro self-hosted variantu (GitLab \glstext{EE}).

    Dostupnost kontrolních serverů ma suverénně nejlepší Concourse, který umožňuje provozovat více masterů. GitLab může mít zaregistrováno více masterů (runnerů), ale každý se stará o~svoji skupinu pipeline. Dostupnost agentů není uvedena. U~všech \CI jsou joby stavové a z~principu není možné je replikovat.

    \newpage
    \vspace*{-0.3cm}
    \begin{adjustwidth}{-2cm}{}
        \begin{tabular}{r||p{3.2cm}|p{2.7cm}|p{2.9cm}|p{3.2cm}|}\hline
            & \textbf{CircleCI 2.0} & \textbf{Travis CI} & \textbf{SemaphoreCI} & \textbf{GitHub Actions beta} \\\hline\hline
            \textbf{Homepage} & \url{circleci.com} & \url{travis-ci.org} & \url{semaphoreci.com} & \url{github.com/actions} \\\hline
            \textbf{SaaS} & \Cg zdarma, placené & zdarma opensource, placené & \Cg zdarma, placené & zdarma (GitHub tarif) \\\hline
            \textbf{Self-Hosted} & \textcolor{tred}{ne} & \textcolor{tred}{ne} & \textcolor{tred}{ne} & ne (jen komunitní implementace) \\\hline
            \textbf{Dostupnost masteru} & 99.90\% & 99.93\% & 100\% & zatím neaplikovatelné \\\hline
            \textbf{Možnosti izolace} & kontejner (mezi organizacemi VM) & VM & VM & kontejner (mezi organizacemi VM) \\\hline
            \textbf{Joby} & kontejner & host & host & kontejner\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \  \\\hline
            \textbf{Rozšiřitelnost} & \textcolor{tred}{ne} & \textcolor{tred}{ne} & \textcolor{tred}{ne} & \textcolor{tred}{ne}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \\\hline
            \textbf{Složitost pipeline} & \CrA 9 & \CgA 1 & \CrC 6 & 4 \\\hline
            \textbf{UX} & \CgB 2 & \CgB 2 & \CgC 3 & 4 \\\hline
            \textbf{Integrace} & GitHub, Bitbucket & GitHub & GitHub & GitHub \\\hline
        \end{tabular}
    \end{adjustwidth}
    \vspace*{0.3cm}

    Dále jsou \CI klasifikované podle úrovně izolace. Všechny self-hosted řešení nabízí izolaci kontejnery (ať už je přímo zabudovaná, je k~dispozici pomocí rozšíření, nebo ji lze implementovat na úrovni samotného jobu). Díky master+agent architektuře lze také dosáhnout fyzické izolace, kde různí agenti běží na odlišných serverech. U~\CI která nejsou postavená čistě na kontejnerech lze dosáhnout i žádné izolace. GitLab, Jenkins a GoCD ještě umožňují vytvářet dynamicky \glstext{VM}. U~\glstext{SaaS} řešení která staví na kontejnerech není úplně jasné, jakou izolaci nabízí, a není to veřejně dostupná informace. Dá se ale očekávat, že uživatelé/organizace budou na oddělené \glstext{VM}.

    V~řádku \textit{Joby} jsou porovnány možnosti konfigurace. U~možnosti \textit{host} běží všechny příkazy na jedné \glstext{VM} a typicky nelze opakovat jenom části pipeline, ale konfigurace bývá intuitivnější. Oproti tomu varianta \textit{kontejner} označuje \CI, která rozdělují pipeline na různé části, kde každá se spouští v~předem vytvořeném Docker kontejneru.

    Přestože jsem do metodiky zahrnul rigorózní testování dostupnosti, byly získané výsledky binární: aplikace jsou buď navrženy distribuovaně a mají tedy pro všechny úkony během správy perfektní dostupnost, nebo je nutné je vypnout a jsou tedy kompletně nedostupné. Při měření času nedostupnosti bych tak pouze porovnával jak dlouho aplikace startují. Místo toho jsem naměřené výsledky promítnul v~tabulce jako \textit{Dostupnost masteru}.

    Složitost pipeline a \glstext{UX} jsou čistě subjektivní relativní hodnocení. Škála je od 1 do 9, kde 1 je nejlepší skóre.

    \subsection{Použití jednotlivých \CI}
        \begin{description}
            \item[GitLab] Skvělé \CI. Podporuje jen repozitáře na GitLab. Dobrá podpora \CD díky integraci s~Kubernetes.
            \item[Jenkins] Nejobecnější \CI s~nejhorším \glstext{UX}. Použil bych až jako poslední možnost, pokud narazím na limitace jiných \CI.
            \item[GoCD] Funkčně stejné nebo horší než Jenkins, má menší komunitu, není tak udržovaný. Má nevýznamně lepší \glstext{UX}.
            \item[Drone] Minimalistické \CI. Cena stejná jako u~GitLab, za řádově míň funkcí. Využil bych pro cloud-ready organizace, které pracují výhradně s~kontejnery a mají repozitáře jinde než na GitLab.
            \item[Concourse] Alternativa ke Drone, má výrazně složitější konfiguraci a horší \glstext{UX}. Největší výhoda Concourse je vynikající dostupnost kontrolní roviny a cena.
            \item[CircleCI] \glstext{SaaS} varianta Drone. Limitující faktor je cena. V~rozhodování můžou hrát roli izolace a rychlost.
            \item[Travis CI] \glstext{SaaS} varianta \CI nezaloženého na kontejnerech.
            \item[Semaphore CI] Alternativa k~Travis~CI s~komplikovanější konfigurací, ale za lepší cenu.
            \item[GitHub Actions] Novinka, pravděpodobně bude používané jako doplněk k~dalším \CI.
        \end{description}
